# Random walk solution of Laplace's equation

import pylab as plt
import numpy as np
import random as rnd

plt.rcParams.update({'font.size': 14})

# Linear dimension
L = 10

# The grid spacing is L/n
# The grid is n+1 points along x and y, including boundary points 0 and n
n = 10

# Initialize the grid to 0
v = np.ones((n+1, n+1)) * 9
vb_list = []

# Set the boundary conditions
for i in range(1,n):
    v[0,i] = 10
    v[n,i] = 10
    v[i,0] = 5
    v[i,n] = 5

def randomwalk(step):
    # Random-walk generator
    x = 5                                       # initial point in matrix
    y = 5

    for i in range(step):

        if x == 9 or y == 9 or x == 0 or y == 0: 
            vb_list.append(v[x,y])
            #print(vb_list)
            break
        
        else:
            n = rnd.randint(0,3)
            if n == 0:
                x += 1
                y = y
                v[x,y] = v[x+1][y]

            elif n == 1:
                x -= 1
                y = y
                v[x,y] = v[x-1][y] 

            elif n == 2: 
                x = x
                y += 1
                v[x,y] = v[x][y+1]

            elif n == 3:
                x = x
                y -= 1
                v[x,y] = v[x][y-1]

n_list = range(100,2100,100)
V_list = []
# Collect 100 mean values of V
for N in n_list:
    v_av_list = []    

    # Collect 100 V
    for j in range(100):                          # ger mig 100 V

        # Collect N Vb 
        for i in range(0,N):
            randomwalk(100)                       # ger mig lista med N st Vb

        v_av = np.average(vb_list)                # ger mig 1 V
        v_av_list.append(v_av)
    
    V = np.average(v_av_list)                     # average of V:s lol
    V_list.append(V)
    print(V)

print(V_list)

# --------------------------------------------------------- PLOTS -------------------------------------------------------------------------------------------------------------------------------------
# # 10.17a
# n100 = [7.7272727272727275, 7.626262626262626, 7.651006711409396, 7.5879396984924625, 7.590361445783133, 7.5711892797319935, 7.543103448275862, 7.569095477386934, 7.581005586592179, 7.585513078470825, 7.5663311985361394, 7.573467674223342, 7.573643410852713, 7.553956834532374, 7.536962365591398, 7.555135475740391, 7.551867219917012, 7.567189249720045, 7.595440084835631, 7.599496221662468, 7.597122302158273, 7.608695652173913, 7.618213660245184, 7.626940830885439, 7.618855761482675, 7.613328167376985, 7.62775083923909, 7.623157137720245, 7.603262755987505, 7.606507883260651, 7.590068159688413, 7.588808550770198, 7.585365853658536, 7.593962710861201, 7.58120149468238, 7.583123777591506, 7.586347565950503, 7.582737622451681, 7.582559339525284, 7.574195171026157, 7.574233128834356, 7.584431137724551, 7.5701918577445015, 7.571461239423736, 7.565392354124748, 7.563962387929149, 7.564212328767123, 7.559723386420788, 7.555418719211823, 7.54728370221328, 7.548342541436464, 7.547407120743034, 7.5465072133637054, 7.544709388971684, 7.532004389173372, 7.534578767738458, 7.52779248279513, 7.526443558175828, 7.534515084370207, 7.5314228255404725, 7.531322123310254, 7.532435939020434, 7.5307262569832405, 7.534956794972506, 7.536736272235112, 7.543792840822544, 7.544267707082833, 7.5499038888067425, 7.543348389916946, 7.543091065785694, 7.539648824695553, 7.5408462505236695, 7.536152045172841, 7.530906126884934, 7.537863557163919, 7.538024070890094, 7.5427489883827175, 7.539948453608248, 7.537854688891716, 7.530786629806484, 7.53009805138389, 7.526664214784847, 7.523619186046512, 7.52513164193394, 7.521584861028977, 7.523380874444705, 7.521955165241507, 7.521704363719443, 7.516941495369324, 7.512565620462415, 7.513809102960671, 7.510108184897826, 7.505675062155443, 7.5037433155080215, 7.50185204783575, 7.500785422557336, 7.503368224686496, 7.503846548363935, 7.502284495887907, 7.500502613590672]
# n1000 = [7.7, 7.571285642821411, 7.517529215358931, 7.484977466199299, 7.477955911823647, 7.479124916499666, 7.494631352899069, 7.484962406015038, 7.499721572558191, 7.494987971130714, 7.505923090942227, 7.508146043946863, 7.504243172349946, 7.504477398094419, 7.4991640473483585, 7.504231709610683, 7.502802525222727, 7.507244761480161, 7.506599788806758, 7.506896032900346, 7.4982089124516405, 7.499658111865798, 7.4952036278015175, 7.4939406602590894, 7.4918769304825705, 7.491802646298654, 7.491177890865867, 7.487911458146781, 7.490748746325437, 7.4888004814121425, 7.4886760709201505, 7.487384422504309, 7.4860938022432295, 7.491960466145449, 7.491258741258742, 7.490108665366398, 7.490850435112641, 7.492411244555893, 7.492862837889972, 7.491850142935955, 7.490030581039755, 7.491342870107229, 7.48722912924821, 7.490369053317832, 7.490973522332174, 7.489315773407178, 7.48724898098551, 7.484745904379806, 7.484698994944016, 7.483400533590099, 7.48416912487709, 7.4864025613331275, 7.486659854677566, 7.487975188961316, 7.486598840389454, 7.485852435530086, 7.483769375582807, 7.486081333425548, 7.487719059679421, 7.486753472512411, 7.485490686089144, 7.485158284669762, 7.484120540617986, 7.48237119217751, 7.482179775974327, 7.482943580860343, 7.482787007932944, 7.482635048444897, 7.482450913424506, 7.4837027379400265, 7.484567683245519, 7.486105500689502, 7.486570773056369, 7.486989754431615, 7.486962451861361, 7.485417931325714, 7.484402881071154, 7.484378214359185, 7.484448788909765, 7.484392237488717, 7.4849873088590355, 7.484834030478707, 7.484291548853283, 7.485433183685165, 7.485192089862186, 7.48600583090379, 7.487117413107383, 7.4867791201276495, 7.486984155604138, 7.486209394327743, 7.485975643357029, 7.487627270150653, 7.487194418383963, 7.487650567060355, 7.487278831130443, 7.486889116399574, 7.488445910317518, 7.489868598796512, 7.4903760434395, 7.490071206498847]
# plt.figure()
# plt.title("Random-walk solution of Laplace's equation with initial point (x,y)=(5,5)")
# plt.xlabel("Iterations")
# plt.ylabel("Potential")
# plt.plot(range(100), n100, 'b', label="n = 100")
# plt.plot(range(100), n1000, 'r', label="n = 1000")
# plt.legend()
# plt.show()

# n = [7.54624711241961, 7.510408409887927, 7.511428357497635, 7.51317302916969, 7.514393284616822, 7.508636407832267, 7.5073196750004625, 7.506401787395497, 7.504224560526318, 7.501648306892093, 7.5001837406487, 7.5002195486099685, 7.499605484146574, 7.498942421744976, 7.498131562938038, 7.499458221466597, 7.500463553594891, 7.5012316300743995, 7.501513427480391, 7.5011554029613965]
# plt.figure()
# plt.title("Random-walk solution of Laplace's equation with initial point (x,y)=(5,5)")
# plt.xlabel("Random walkers n")
# plt.ylabel("Potential")
# plt.plot(range(100,2100,100), n, 'b')
# plt.show()

# # 10.17b
# n100b = [5.95, 5.95, 6.116666666666666, 6.0875, 6.04, 6.066666666666666, 6.064285714285714, 6.06875, 6.017797552836485, 6.046046046046046, 6.050955414012739, 6.017514595496247, 6.0046189376443415, 6.015010721944246, 6.020680453635757, 6.029411764705882, 6.010011778563015, 5.998331479421579, 5.990516332982087, 5.986479719579369, 5.97520267048164, 5.960400546199363, 5.953417501088376, 5.955360867751356, 5.947136563876652, 5.947611710323574, 5.947700296735905, 5.9370529327610875, 5.946132596685083, 5.946261682242991, 5.947997416020672, 5.946495619524406, 5.951152912621359, 5.945229681978798, 5.948226544622425, 5.936022253129346, 5.940460081190798, 5.940711462450593, 5.937098844672657, 5.934918648310388, 5.932844932844933, 5.9370529327610875, 5.933861201676758, 5.933090578060992, 5.9334668446817975, 5.9403569873748365, 5.9384320409032805, 5.942845223195661, 5.948099713935431, 5.947136563876652, 5.9491558696505695, 5.951097420100115, 5.946354363430299, 5.945494994438265, 5.947397160538769, 5.95012513407222, 5.948366701791359, 5.947531929582326, 5.9526637258228705, 5.955121788455122, 5.949294387922547, 5.948498546980949, 5.947727994915793, 5.950109477635283, 5.952417616261164, 5.950106157112526, 5.950851508813863, 5.949367088607595, 5.95082680591819, 5.9493851873034025, 5.9515083168875105, 5.948012232415902, 5.950781464217164, 5.949546868659543, 5.948885626584812, 5.9475833004082705, 5.948264656180943, 5.94828692416271, 5.94387431901685, 5.943325409733517, 5.942790065488694, 5.939826681313316, 5.940062711046792, 5.938393708293613, 5.9361752237399905, 5.935172253258846, 5.932466635987114, 5.930959963603276, 5.92948717948718, 5.930271352313167, 5.930488341399032, 5.929068755439513, 5.928755919070168, 5.932176320272572, 5.930257058575642, 5.929941618015013, 5.92963268675196, 5.92984068627451, 5.932066316215123, 5.931244995996797]
# n1000b = [5.975, 5.978478478478478, 5.942609275942609, 5.956967725794346, 5.960960960960961, 5.96445853495745, 5.962666285223859, 5.9541984732824424, 5.941045606229143, 5.943821349889846, 5.9466593846714, 5.93984648756883, 5.936465152098576, 5.943220823798627, 5.950410465193887, 5.948626493961579, 5.962603062426384, 5.9613994104232715, 5.9611635137271435, 5.960854983230715, 5.965435041716329, 5.962912400455062, 5.960910634222783, 5.9617470382112465, 5.959875060067275, 5.95853226551671, 5.955249888773543, 5.9530959530959535, 5.948772826124478, 5.947240205566309, 5.946360524446167, 5.944314093539809, 5.94600333687244, 5.949562759473545, 5.946143065526414, 5.948057725996163, 5.949218115902819, 5.950054002792339, 5.950847022587269, 5.9485973122450515, 5.949265100835002, 5.948255315092001, 5.94748114349567, 5.945284950517575, 5.946745562130178, 5.947095819459859, 5.945580404685836, 5.945151199165798, 5.946616817847512, 5.9456835108512855, 5.944688702206171, 5.945368445368445, 5.94494286523751, 5.9436637994957735, 5.944376695000091, 5.945136666726255, 5.942516421370613, 5.940331739648238, 5.942277346997642, 5.9411705819540845, 5.942300118156755, 5.942661994800665, 5.9418401398379155, 5.942608205978507, 5.942212022733224, 5.941950945743018, 5.942099364960777, 5.942050323169565, 5.941077465503983, 5.941433066361556, 5.940862110294844, 5.940850123055104, 5.939411393620231, 5.93840471874239, 5.938492752075603, 5.939142461964039, 5.9383207218451775, 5.937199183704902, 5.937361397995261, 5.938770913368288, 5.938983092742733, 5.9389344662564705, 5.939090580147147, 5.938040019544983, 5.937978470308341, 5.9375363769701766, 5.938265922559117, 5.93789816163087, 5.937707388952004, 5.93735400769727, 5.937063398642479, 5.937421790840143, 5.9381054897739505, 5.9377096667696145, 5.9381026143584235, 5.938141964816418, 5.9377999318864365, 5.938179923797461, 5.938176229093777, 5.9387951228302]
# plt.title("Random-walk solution of Laplace's equation with initial point (x,y)=(5,1)")
# plt.xlabel("Iterations")
# plt.ylabel("Potential")
# plt.plot(range(100), n100b, 'b', label="n = 100")
# plt.plot(range(100), n1000b, 'r', label="n = 1000")
# plt.legend()
# plt.show()

# n100bb = [8.85, 8.99497487437186, 9.046822742474916, 9.110275689223057, 9.138276553106213, 9.156928213689483, 9.13447782546495, 9.155193992490613, 9.149054505005562, 9.11911911911912, 9.112829845313922, 9.136060100166945, 9.129429892141756, 9.113018597997138, 9.085447263017356, 9.086357947434292, 9.081272084805654, 9.082313681868744, 9.083245521601686, 9.081581581581581, 9.07769304099142, 9.083257506824387, 9.101392515230636, 9.08673894912427, 9.091273018414732, 9.103156274056968, 9.108598962194218, 9.113652609006433, 9.113181504485853, 9.111074049366245, 9.105874757908328, 9.104127579737336, 9.117647058823529, 9.118599175985874, 9.112349914236706, 9.105058365758754, 9.103569497025418, 9.098209583991574, 9.103386351975372, 9.10057543157368, 9.094459360507688, 9.096974029068383, 9.090062834535722, 9.090288833295428, 9.082721814543028, 9.082010006525994, 9.077070470513094, 9.077356130108424, 9.076797385620916, 9.076261008807046, 9.073601570166831, 9.077782056218714, 9.072534945221005, 9.06933629959214, 9.068984346559883, 9.066857347157669, 9.065683175272216, 9.0714532274767, 9.068544282321005, 9.05905905905906, 9.065474236954381, 9.059573781078463, 9.05783285668891, 9.057710353456365, 9.059131506005544, 9.061267819229602, 9.061846429638482, 9.058728289667354, 9.056425877574704, 9.055619102087503, 9.056949534818155, 9.05046573057139, 9.051144933497875, 9.057892601109158, 9.058454557587082, 9.057684709600949, 9.058234758871702, 9.061978698832286, 9.060559989864437, 9.064806705867634, 9.064005931051526, 9.060783595752472, 9.060050645122393, 9.054569283927082, 9.055104203461674, 9.057844506517691, 9.05775425678785, 9.055959963603275, 9.054099651332809, 9.050161272383495, 9.05070949290507, 9.053421825699054, 9.054999461844796, 9.052284101799595, 9.055420925086924, 9.057449692419977, 9.056340934888041, 9.051680114390766, 9.05570720857345, 9.057651886698029]
# n1000bb = [9.12912912912913, 9.109554777388695, 9.117156208277704, 9.136420525657071, 9.137620192307692, 9.136204306459689, 9.131025604348448, 9.127143035915404, 9.11214953271028, 9.103334334635026, 9.10121052152544, 9.103195128055393, 9.105644105644105, 9.11125411125411, 9.112720234917244, 9.107489207282738, 9.114009775631589, 9.112575782857778, 9.108130895294304, 9.101967262351705, 9.099251561233732, 9.098107025846378, 9.098585418933624, 9.094189296291662, 9.09094549677626, 9.088300985828711, 9.082699796031893, 9.080457715000893, 9.080410164341941, 9.077195207422488, 9.075156643627672, 9.074184161947374, 9.07208519159006, 9.071260306242639, 9.06704997282531, 9.065020301462818, 9.063912114078523, 9.063471570848922, 9.06297332682977, 9.062077596996245, 9.06427821330012, 9.064749916559386, 9.063853569931535, 9.062969368713304, 9.061456989008056, 9.061819764910753, 9.06092884533447, 9.060179390905299, 9.059032673328021, 9.058113222660552, 9.05832809800534, 9.060093191620457, 9.060433747685797, 9.059556478528517, 9.060019660671376, 9.059840520632196, 9.059299854209481, 9.058432591058173, 9.058427233233777, 9.05967359743684, 9.059335248256053, 9.058134840532903, 9.058005562177195, 9.05811497849042, 9.058177505314069, 9.058266713186997, 9.058740903453325, 9.057406616705192, 9.057852199022012, 9.05580903070784, 9.055700486497921, 9.05687269693388, 9.05773846259343, 9.058107285395387, 9.057331642528199, 9.058157149443456, 9.059221218227915, 9.060438432117463, 9.062016879134248, 9.061365968416048, 9.060151769824007, 9.05928385686904, 9.059993486834964, 9.059148114601706, 9.059511471239459, 9.059320652806557, 9.059202577527184, 9.058678315870903, 9.058323959505062, 9.058008898776418, 9.058120090651059, 9.057324424905874, 9.058301756803306, 9.058799096873136, 9.058633844078656, 9.057126171879073, 9.057413848265613, 9.05793178126692, 9.05824653655577, 9.058163980378417]
# plt.title("Random-walk solution of Laplace's equation with initial point (x,y)=(1,5)")
# plt.xlabel("Iterations")
# plt.ylabel("Potential")
# plt.plot(range(100), n100bb, 'b', label="n = 100")
# plt.plot(range(100), n1000bb, 'r', label="n = 1000")
# plt.legend()
# plt.show()

# nb = [6.003231367414328, 5.938721184276934, 5.935228303424532, 5.936547646973326, 5.934009655643161, 5.932280056488491, 5.932635140634432, 5.932735545867489, 5.932887939924845, 5.935494379050038, 5.9350818577221345, 5.935937298413332, 5.93630430927783, 5.936364224538893, 5.936121291712506, 5.93565219416667, 5.935353347677347, 5.935587336003079, 5.935969986564141, 5.936188645716718]
# plt.figure()
# plt.title("Random-walk solution of Laplace's equation with initial point (x,y)=(5,1)")
# plt.xlabel("Random walkers n")
# plt.ylabel("Potential")
# plt.plot(range(100,2100,100), nb, 'b')
# plt.show()

# nbb = [9.104985979111687, 9.059282793986753, 9.064747347296748, 9.064213252839593, 9.062894204540237, 9.060890240985787, 9.062131300883406, 9.062308885362107, 9.062260131664866, 9.062588061813432, 9.063665881416801, 9.062642446798181, 9.06260385676928, 9.063373230920257, 9.064161837636497, 9.064451628036634, 9.064643981904497, 9.064371142953087, 9.064189562926448, 9.064519046918408]
# plt.figure()
# plt.title("Random-walk solution of Laplace's equation with initial point (x,y)=(1,5)")
# plt.xlabel("Random walkers n")
# plt.ylabel("Potential")
# plt.plot(range(100,2100,100), nbb, 'b')
# plt.show()



